"use strict";(globalThis.webpackChunkknowledge_bank=globalThis.webpackChunkknowledge_bank||[]).push([[4787],{2375(r,n,e){e.r(n),e.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"frontend/react/archive/routing","title":"\u0420\u043e\u0443\u0442\u0438\u043d\u0433","description":"react-router-dom","source":"@site/docs/3 - frontend/5 - react/88-archive/9-routing.md","sourceDirName":"3 - frontend/5 - react/88-archive","slug":"/frontend/react/archive/routing","permalink":"/knowledge-bank/docs/frontend/react/archive/routing","draft":false,"unlisted":false,"editUrl":"https://github.com/EvgenyLeukhin/knowledge-bank/edit/main/docs/3 - frontend/5 - react/88-archive/9-routing.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"title":"\u0420\u043e\u0443\u0442\u0438\u043d\u0433","sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","permalink":"/knowledge-bank/docs/frontend/react/archive/best-practice"},"next":{"title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0441\u0442\u0438\u043b\u0438","permalink":"/knowledge-bank/docs/frontend/react/archive/components"}}');var o=e(4848),s=e(8453);const i={title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433",sidebar_position:9},a=void 0,c={},d=[{value:"react-router-dom",id:"react-router-dom",level:2},{value:"react-router-dom v. 5",id:"react-router-dom-v-5",level:2},{value:"App - create router",id:"app---create-router",level:3},{value:"Router - routes",id:"router---routes",level:3},{value:"PermissionsRoute",id:"permissionsroute",level:3},{value:"history - redirects",id:"history---redirects",level:3},{value:"NavLink",id:"navlink",level:3},{value:"react-router-dom v. 6",id:"react-router-dom-v-6",level:2},{value:"App",id:"app",level:3},{value:"Router",id:"router",level:3},{value:"NavLink",id:"navlink-1",level:3},{value:"Navigation",id:"navigation",level:3}];function u(r){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"react-router-dom",children:"react-router-dom"}),"\n",(0,o.jsxs)(n.p,{children:["\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432: ",(0,o.jsx)(n.code,{children:"yarn add react-router-dom @types/react-router-dom"})]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"react-router-dom-v-5",children:"react-router-dom v. 5"}),"\n",(0,o.jsx)(n.h3,{id:"app---create-router",children:"App - create router"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import { BrowserRouter as Router } from 'react-router-dom';\r\nimport Routes from 'routes';\r\n\r\n...\r\n  <Router>\r\n      <Routes />\r\n  </Router>\r\n...\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"router---routes",children:"Router - routes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import { matchPath, Redirect, Route, Switch } from 'react-router-dom';\r\nimport { IRoute } from './interfaces';\r\nimport { EPermission } from './interfaces/auth';\r\n\r\n// routes components\r\nimport {\r\n  Login,\r\n  Drugstores,\r\n  Edit,\r\n  Help,\r\n  MassEdit,\r\n  Map,\r\n  MapOld,\r\n  CustomStatuses,\r\n  PermissionsRoute,\r\n  Regions,\r\n} from 'container';\r\n\r\nexport const AUTH = 'login';\r\nexport const MAIN = 'main';\r\nexport const MAP = 'map';\r\nexport const MAP_TEST = 'map-test';\r\nexport const EDIT = 'edit';\r\nexport const MASS_EDIT = 'mass_edit';\r\nexport const STATUSES = 'statuses';\r\nexport const HELP = 'help';\r\nexport const REGIONS = 'regions';\r\n\r\nexport const routes: IRoute[] = [\r\n  {\r\n    id: AUTH,\r\n    path: `/${AUTH}`,\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <Login />,\r\n  },\r\n  {\r\n    id: MAIN,\r\n    path: '/',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <Drugstores />,\r\n  },\r\n  {\r\n    id: MASS_EDIT,\r\n    path: '/mass_edit',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <MassEdit />,\r\n  },\r\n  {\r\n    id: EDIT,\r\n    path: '/edit/:id',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <Edit />,\r\n  },\r\n  {\r\n    id: MAP,\r\n    path: '/map',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <Map />,\r\n  },\r\n  {\r\n    id: MAP_TEST,\r\n    path: '/map-test',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <MapOld />,\r\n  },\r\n  {\r\n    id: STATUSES,\r\n    path: '/statuses',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <CustomStatuses />,\r\n  },\r\n  {\r\n    id: HELP,\r\n    path: '/help',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <Help />,\r\n  },\r\n  {\r\n    id: REGIONS,\r\n    path: '/regions',\r\n    exact: true,\r\n    permissions: [EPermission.NONE],\r\n    children: <Regions />,\r\n  },\r\n];\r\n\r\nconst Routes = () => {\r\n  return (\r\n    <Switch>\r\n      {routes.map(props => {\r\n        return <PermissionsRoute key={props.id} {...props} />;\r\n      })}\r\n\r\n      <Route path='*'>\r\n        <Redirect to='/' />\r\n      </Route>\r\n    </Switch>\r\n  );\r\n};\r\n\r\nexport default Routes;\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"permissionsroute",children:"PermissionsRoute"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import { EPermission, IPermission } from 'interfaces/auth';\r\nimport { IRoute } from 'interfaces';\r\nimport { useSelector } from 'react-redux';\r\nimport { TStore } from 'store/store';\r\nimport { useAlert } from 'react-alert';\r\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\r\nimport Loader from 'components/ui/Loader/Loader';\r\nimport { AUTH } from 'routes';\r\nimport { useEffect } from 'react';\r\n\r\ninterface IPermissionsRoute extends RouteProps, IRoute {\r\n  permissions: IPermission[];\r\n}\r\n\r\nconst PermissionsRoute = ({\r\n  children,\r\n  permissions,\r\n  id,\r\n  ...rest\r\n}: IPermissionsRoute) => {\r\n  const alert = useAlert();\r\n\r\n  const {\r\n    permissions: userPermissions,\r\n    sessionInit,\r\n    uId,\r\n  } = useSelector((state: TStore) => ({\r\n    token: state.auth.token,\r\n    uId: state.auth.upn,\r\n    permissions: state.auth.permissions,\r\n    sessionInit: state.auth.init,\r\n  }));\r\n\r\n  let hasPermissions =\r\n    permissions.every(permission => {\r\n      return userPermissions?.includes(permission);\r\n    }) || false;\r\n  if (permissions.includes(EPermission.NONE)) hasPermissions = true;\r\n\r\n  let component;\r\n\r\n  if (!sessionInit) {\r\n    component = <Route {...rest} render={() => <Loader loading={true} />} />;\r\n  } else {\r\n    if (!uId && id !== AUTH) {\r\n      component = <Redirect to='/login' />;\r\n    } else if (!!uId && id === AUTH) {\r\n      component = <Redirect to='/' />;\r\n    } else {\r\n      component = (\r\n        <Route\r\n          {...rest}\r\n          render={() =>\r\n            hasPermissions ? <>{children}</> : <Redirect to='/' />\r\n          }\r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!hasPermissions && sessionInit) {\r\n      alert.error(\r\n        '403. \u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b. \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438',\r\n      );\r\n    }\r\n  }, [sessionInit]);\r\n\r\n  return component;\r\n};\r\n\r\nexport default PermissionsRoute;\n"})}),"\n",(0,o.jsx)(n.h3,{id:"history---redirects",children:"history - redirects"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import { useHistory } from 'react-router-dom';\r\n\r\n...\r\n\r\nconst history = useHistory();\r\n\r\n...\r\n\r\nhistory.push('/some-page');\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"navlink",children:"NavLink"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"...\r\n<NavLink to={`/administration/routes?query=${someConts}`} target='_blank'>\r\n    Link to new page\r\n</NavLink>\r\n...\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"react-router-dom-v-6",children:"react-router-dom v. 6"}),"\n",(0,o.jsx)(n.h3,{id:"app",children:"App"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import * as React from 'react';\r\nimport * as ReactDOM from 'react-dom/client';\r\nimport { createBrowserRouter, RouterProvider } from 'react-router-dom';\r\n\r\nconst router = createBrowserRouter([\r\n  {\r\n    path: '/',\r\n    element: <div>Hello world!</div>,\r\n  },\r\n]);\r\n\r\nReactDOM.createRoot(document.getElementById('root')).render(\r\n  <React.StrictMode>\r\n    <RouterProvider router={router} />\r\n  </React.StrictMode>,\r\n);\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"router",children:"Router"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"const router = createBrowserRouter([\r\n  {\r\n    path: '/',\r\n    element: <div>Hello world!</div>,\r\n\r\n    // not-found\r\n    errorElement: <NotFoundPage />,\r\n\r\n    // sub-routes\r\n    children: [\r\n      {\r\n        path: 'contacts/:contactId',\r\n        element: <Contact />,\r\n      },\r\n    ],\r\n\r\n    loader: someLoader,\r\n    action: someAction, // import action\r\n  },\r\n]);\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"navlink-1",children:"NavLink"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:'import { NavLink } from "react-router-dom";\r\n\r\n...\r\n\r\n<ul>\r\n  {contacts.map((contact) => (\r\n    <li key={contact.id}>\r\n      <NavLink\r\n        to={`contacts/${contact.id}`}\r\n        className={({ isActive, isPending }) =>\r\n          isActive\r\n            ? "active"\r\n            : isPending\r\n            ? "pending"\r\n            : ""\r\n        }\r\n      >\r\n        {/* other code */}\r\n      </NavLink>\r\n    </li>\r\n  ))}\r\n</ul>\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"navigation",children:"Navigation"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:'import { useNavigation } from "react-router-dom";\r\n\r\n...\r\n\r\nconst navigation = useNavigation();\r\n\r\n\r\n...\r\n\r\n<div\r\n  id="detail"\r\n  className={navigation.state === "loading" ? "loading" : ""}\r\n>\r\n  Some content\r\n</div>\r\n\r\n...\r\nonClick={() => {\r\n  navigation(-1);\r\n  navigation(\'/redirect-page\');\r\n}}\r\n\r\n\n'})})]})}function l(r={}){const{wrapper:n}={...(0,s.R)(),...r.components};return n?(0,o.jsx)(n,{...r,children:(0,o.jsx)(u,{...r})}):u(r)}},8453(r,n,e){e.d(n,{R:()=>i,x:()=>a});var t=e(6540);const o={},s=t.createContext(o);function i(r){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof r?r(n):{...n,...r}},[n,r])}function a(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:i(r.components),t.createElement(s.Provider,{value:n},r.children)}}}]);