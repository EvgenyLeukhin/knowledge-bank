"use strict";(self.webpackChunkknowledge_bank=self.webpackChunkknowledge_bank||[]).push([[2718],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>l});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u=r.createContext({}),c=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(u.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,s=e.originalType,u=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),d=c(t),l=o,f=d["".concat(u,".").concat(l)]||d[l]||m[l]||s;return t?r.createElement(f,i(i({ref:n},p),{},{components:t})):r.createElement(f,i({ref:n},p))}));function l(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var s=t.length,i=new Array(s);i[0]=d;var a={};for(var u in n)hasOwnProperty.call(n,u)&&(a[u]=n[u]);a.originalType=e,a.mdxType="string"==typeof e?e:o,i[1]=a;for(var c=2;c<s;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8236:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var r=t(7462),o=(t(7294),t(3905));const s={title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433 -",sidebar_position:3},i=void 0,a={unversionedId:"frontend/react/routing",id:"frontend/react/routing",title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433 -",description:"react-router-dom",source:"@site/docs/frontend/react/3-routing.md",sourceDirName:"frontend/react",slug:"/frontend/react/routing",permalink:"/knowledge-bank/docs/frontend/react/routing",draft:!1,editUrl:"https://github.com/EvgenyLeukhin/knowledge-bank/edit/main/docs/frontend/react/3-routing.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433 -",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0441\u0442\u0438\u043b\u0438",permalink:"/knowledge-bank/docs/frontend/react/components"},next:{title:"state",permalink:"/knowledge-bank/docs/frontend/react/hooks/state"}},u={},c=[{value:"react-router-dom",id:"react-router-dom",level:2},{value:"react-router-dom v. 5",id:"react-router-dom-v-5",level:2},{value:"Router",id:"router",level:3},{value:"PermissionsRoute",id:"permissionsroute",level:3},{value:"history",id:"history",level:3},{value:"react-router-dom v. 6",id:"react-router-dom-v-6",level:2}],p={toc:c};function m(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"react-router-dom"},"react-router-dom"),(0,o.kt)("p",null,"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432: ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn add react-router-dom @types/react-router-dom")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"react-router-dom-v-5"},"react-router-dom v. 5"),(0,o.kt)("h3",{id:"router"},"Router"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { matchPath, Redirect, Route, Switch } from 'react-router-dom';\nimport { IRoute } from './interfaces';\nimport { EPermission } from './interfaces/auth';\n\n// routes components\nimport {\n  Login,\n  Drugstores,\n  Edit,\n  Help,\n  MassEdit,\n  Map,\n  MapOld,\n  CustomStatuses,\n  PermissionsRoute,\n  Regions,\n} from 'container';\n\nexport const AUTH = 'login';\nexport const MAIN = 'main';\nexport const MAP = 'map';\nexport const MAP_TEST = 'map-test';\nexport const EDIT = 'edit';\nexport const MASS_EDIT = 'mass_edit';\nexport const STATUSES = 'statuses';\nexport const HELP = 'help';\nexport const REGIONS = 'regions';\n\nexport const routes: IRoute[] = [\n  {\n    id: AUTH,\n    path: `/${AUTH}`,\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Login />,\n  },\n  {\n    id: MAIN,\n    path: '/',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Drugstores />,\n  },\n  {\n    id: MASS_EDIT,\n    path: '/mass_edit',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <MassEdit />,\n  },\n  {\n    id: EDIT,\n    path: '/edit/:id',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Edit />,\n  },\n  {\n    id: MAP,\n    path: '/map',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Map />,\n  },\n  {\n    id: MAP_TEST,\n    path: '/map-test',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <MapOld />,\n  },\n  {\n    id: STATUSES,\n    path: '/statuses',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <CustomStatuses />,\n  },\n  {\n    id: HELP,\n    path: '/help',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Help />,\n  },\n  {\n    id: REGIONS,\n    path: '/regions',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Regions />,\n  },\n];\n\nconst Routes = () => {\n  return (\n    <Switch>\n      {routes.map(props => {\n        return <PermissionsRoute key={props.id} {...props} />;\n      })}\n\n      <Route path='*'>\n        <Redirect to='/' />\n      </Route>\n    </Switch>\n  );\n};\n\nexport default Routes;\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"permissionsroute"},"PermissionsRoute"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { EPermission, IPermission } from 'interfaces/auth';\nimport { IRoute } from 'interfaces';\nimport { useSelector } from 'react-redux';\nimport { TStore } from 'store/store';\nimport { useAlert } from 'react-alert';\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\nimport Loader from 'components/ui/Loader/Loader';\nimport { AUTH } from 'routes';\nimport { useEffect } from 'react';\n\ninterface IPermissionsRoute extends RouteProps, IRoute {\n  permissions: IPermission[];\n}\n\nconst PermissionsRoute = ({\n  children,\n  permissions,\n  id,\n  ...rest\n}: IPermissionsRoute) => {\n  const alert = useAlert();\n\n  const {\n    permissions: userPermissions,\n    sessionInit,\n    uId,\n  } = useSelector((state: TStore) => ({\n    token: state.auth.token,\n    uId: state.auth.upn,\n    permissions: state.auth.permissions,\n    sessionInit: state.auth.init,\n  }));\n\n  let hasPermissions =\n    permissions.every(permission => {\n      return userPermissions?.includes(permission);\n    }) || false;\n  if (permissions.includes(EPermission.NONE)) hasPermissions = true;\n\n  let component;\n\n  if (!sessionInit) {\n    component = <Route {...rest} render={() => <Loader loading={true} />} />;\n  } else {\n    if (!uId && id !== AUTH) {\n      component = <Redirect to='/login' />;\n    } else if (!!uId && id === AUTH) {\n      component = <Redirect to='/' />;\n    } else {\n      component = (\n        <Route\n          {...rest}\n          render={() =>\n            hasPermissions ? <>{children}</> : <Redirect to='/' />\n          }\n        />\n      );\n    }\n  }\n\n  useEffect(() => {\n    if (!hasPermissions && sessionInit) {\n      alert.error(\n        '403. \u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b. \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438',\n      );\n    }\n  }, [sessionInit]);\n\n  return component;\n};\n\nexport default PermissionsRoute;\n\n")),(0,o.kt)("h3",{id:"history"},"history"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useHistory } from 'react-router-dom';\n\n...\n\nconst history = useHistory();\n\n...\n\nhistory.push('/some-page');\n\n")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"react-router-dom-v-6"},"react-router-dom v. 6"),(0,o.kt)("p",null,"TODO"))}m.isMDXComponent=!0}}]);