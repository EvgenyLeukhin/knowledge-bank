"use strict";(globalThis.webpackChunkknowledge_bank=globalThis.webpackChunkknowledge_bank||[]).push([[4787],{2375(n,e,t){t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"frontend/react/archive/routing","title":"\u0420\u043e\u0443\u0442\u0438\u043d\u0433","description":"react-router-dom","source":"@site/docs/3 - frontend/5 - react/88-archive/9-routing.md","sourceDirName":"3 - frontend/5 - react/88-archive","slug":"/frontend/react/archive/routing","permalink":"/knowledge-bank/docs/frontend/react/archive/routing","draft":false,"unlisted":false,"editUrl":"https://github.com/EvgenyLeukhin/knowledge-bank/edit/main/docs/3 - frontend/5 - react/88-archive/9-routing.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"title":"\u0420\u043e\u0443\u0442\u0438\u043d\u0433","sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","permalink":"/knowledge-bank/docs/frontend/react/archive/best-practice"},"next":{"title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0441\u0442\u0438\u043b\u0438","permalink":"/knowledge-bank/docs/frontend/react/archive/components"}}');var o=t(4848),s=t(8453);const i={title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433",sidebar_position:9},a=void 0,c={},d=[{value:"react-router-dom",id:"react-router-dom",level:2},{value:"react-router-dom v. 5",id:"react-router-dom-v-5",level:2},{value:"App - create router",id:"app---create-router",level:3},{value:"Router - routes",id:"router---routes",level:3},{value:"PermissionsRoute",id:"permissionsroute",level:3},{value:"history - redirects",id:"history---redirects",level:3},{value:"NavLink",id:"navlink",level:3},{value:"react-router-dom v. 6",id:"react-router-dom-v-6",level:2},{value:"App",id:"app",level:3},{value:"Router",id:"router",level:3},{value:"NavLink",id:"navlink-1",level:3},{value:"Navigation",id:"navigation",level:3}];function u(n){const e={code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"react-router-dom",children:"react-router-dom"}),"\n",(0,o.jsxs)(e.p,{children:["\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432: ",(0,o.jsx)(e.code,{children:"yarn add react-router-dom @types/react-router-dom"})]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"react-router-dom-v-5",children:"react-router-dom v. 5"}),"\n",(0,o.jsx)(e.h3,{id:"app---create-router",children:"App - create router"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import { BrowserRouter as Router } from 'react-router-dom';\nimport Routes from 'routes';\n\n...\n  <Router>\n      <Routes />\n  </Router>\n...\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"router---routes",children:"Router - routes"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import { matchPath, Redirect, Route, Switch } from 'react-router-dom';\nimport { IRoute } from './interfaces';\nimport { EPermission } from './interfaces/auth';\n\n// routes components\nimport {\n  Login,\n  Drugstores,\n  Edit,\n  Help,\n  MassEdit,\n  Map,\n  MapOld,\n  CustomStatuses,\n  PermissionsRoute,\n  Regions,\n} from 'container';\n\nexport const AUTH = 'login';\nexport const MAIN = 'main';\nexport const MAP = 'map';\nexport const MAP_TEST = 'map-test';\nexport const EDIT = 'edit';\nexport const MASS_EDIT = 'mass_edit';\nexport const STATUSES = 'statuses';\nexport const HELP = 'help';\nexport const REGIONS = 'regions';\n\nexport const routes: IRoute[] = [\n  {\n    id: AUTH,\n    path: `/${AUTH}`,\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Login />,\n  },\n  {\n    id: MAIN,\n    path: '/',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Drugstores />,\n  },\n  {\n    id: MASS_EDIT,\n    path: '/mass_edit',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <MassEdit />,\n  },\n  {\n    id: EDIT,\n    path: '/edit/:id',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Edit />,\n  },\n  {\n    id: MAP,\n    path: '/map',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Map />,\n  },\n  {\n    id: MAP_TEST,\n    path: '/map-test',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <MapOld />,\n  },\n  {\n    id: STATUSES,\n    path: '/statuses',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <CustomStatuses />,\n  },\n  {\n    id: HELP,\n    path: '/help',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Help />,\n  },\n  {\n    id: REGIONS,\n    path: '/regions',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Regions />,\n  },\n];\n\nconst Routes = () => {\n  return (\n    <Switch>\n      {routes.map(props => {\n        return <PermissionsRoute key={props.id} {...props} />;\n      })}\n\n      <Route path='*'>\n        <Redirect to='/' />\n      </Route>\n    </Switch>\n  );\n};\n\nexport default Routes;\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"permissionsroute",children:"PermissionsRoute"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import { EPermission, IPermission } from 'interfaces/auth';\nimport { IRoute } from 'interfaces';\nimport { useSelector } from 'react-redux';\nimport { TStore } from 'store/store';\nimport { useAlert } from 'react-alert';\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\nimport Loader from 'components/ui/Loader/Loader';\nimport { AUTH } from 'routes';\nimport { useEffect } from 'react';\n\ninterface IPermissionsRoute extends RouteProps, IRoute {\n  permissions: IPermission[];\n}\n\nconst PermissionsRoute = ({\n  children,\n  permissions,\n  id,\n  ...rest\n}: IPermissionsRoute) => {\n  const alert = useAlert();\n\n  const {\n    permissions: userPermissions,\n    sessionInit,\n    uId,\n  } = useSelector((state: TStore) => ({\n    token: state.auth.token,\n    uId: state.auth.upn,\n    permissions: state.auth.permissions,\n    sessionInit: state.auth.init,\n  }));\n\n  let hasPermissions =\n    permissions.every(permission => {\n      return userPermissions?.includes(permission);\n    }) || false;\n  if (permissions.includes(EPermission.NONE)) hasPermissions = true;\n\n  let component;\n\n  if (!sessionInit) {\n    component = <Route {...rest} render={() => <Loader loading={true} />} />;\n  } else {\n    if (!uId && id !== AUTH) {\n      component = <Redirect to='/login' />;\n    } else if (!!uId && id === AUTH) {\n      component = <Redirect to='/' />;\n    } else {\n      component = (\n        <Route\n          {...rest}\n          render={() =>\n            hasPermissions ? <>{children}</> : <Redirect to='/' />\n          }\n        />\n      );\n    }\n  }\n\n  useEffect(() => {\n    if (!hasPermissions && sessionInit) {\n      alert.error(\n        '403. \u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b. \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438',\n      );\n    }\n  }, [sessionInit]);\n\n  return component;\n};\n\nexport default PermissionsRoute;\n"})}),"\n",(0,o.jsx)(e.h3,{id:"history---redirects",children:"history - redirects"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import { useHistory } from 'react-router-dom';\n\n...\n\nconst history = useHistory();\n\n...\n\nhistory.push('/some-page');\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"navlink",children:"NavLink"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"...\n<NavLink to={`/administration/routes?query=${someConts}`} target='_blank'>\n    Link to new page\n</NavLink>\n...\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"react-router-dom-v-6",children:"react-router-dom v. 6"}),"\n",(0,o.jsx)(e.h3,{id:"app",children:"App"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import * as React from 'react';\nimport * as ReactDOM from 'react-dom/client';\nimport { createBrowserRouter, RouterProvider } from 'react-router-dom';\n\nconst router = createBrowserRouter([\n  {\n    path: '/',\n    element: <div>Hello world!</div>,\n  },\n]);\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <RouterProvider router={router} />\n  </React.StrictMode>,\n);\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"router",children:"Router"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"const router = createBrowserRouter([\n  {\n    path: '/',\n    element: <div>Hello world!</div>,\n\n    // not-found\n    errorElement: <NotFoundPage />,\n\n    // sub-routes\n    children: [\n      {\n        path: 'contacts/:contactId',\n        element: <Contact />,\n      },\n    ],\n\n    loader: someLoader,\n    action: someAction, // import action\n  },\n]);\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"navlink-1",children:"NavLink"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:'import { NavLink } from "react-router-dom";\n\n...\n\n<ul>\n  {contacts.map((contact) => (\n    <li key={contact.id}>\n      <NavLink\n        to={`contacts/${contact.id}`}\n        className={({ isActive, isPending }) =>\n          isActive\n            ? "active"\n            : isPending\n            ? "pending"\n            : ""\n        }\n      >\n        {/* other code */}\n      </NavLink>\n    </li>\n  ))}\n</ul>\n'})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"navigation",children:"Navigation"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:'import { useNavigation } from "react-router-dom";\n\n...\n\nconst navigation = useNavigation();\n\n\n...\n\n<div\n  id="detail"\n  className={navigation.state === "loading" ? "loading" : ""}\n>\n  Some content\n</div>\n\n...\nonClick={() => {\n  navigation(-1);\n  navigation(\'/redirect-page\');\n}}\n\n\n'})})]})}function l(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(u,{...n})}):u(n)}},8453(n,e,t){t.d(e,{R:()=>i,x:()=>a});var r=t(6540);const o={},s=r.createContext(o);function i(n){const e=r.useContext(s);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);