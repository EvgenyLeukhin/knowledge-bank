"use strict";(self.webpackChunkknowledge_bank=self.webpackChunkknowledge_bank||[]).push([[6998],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>m});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),u=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},l=function(e){var n=u(e.components);return r.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,l=a(e,["components","mdxType","originalType","parentName"]),d=u(t),m=o,v=d["".concat(c,".").concat(m)]||d[m]||p[m]||i;return t?r.createElement(v,s(s({ref:n},l),{},{components:t})):r.createElement(v,s({ref:n},l))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,s=new Array(i);s[0]=d;var a={};for(var c in n)hasOwnProperty.call(n,c)&&(a[c]=n[c]);a.originalType=e,a.mdxType="string"==typeof e?e:o,s[1]=a;for(var u=2;u<i;u++)s[u]=t[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},9974:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>u});var r=t(7462),o=(t(7294),t(3905));const i={title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433",sidebar_position:9},s=void 0,a={unversionedId:"frontend/react/archive/routing",id:"frontend/react/archive/routing",title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433",description:"react-router-dom",source:"@site/docs/frontend/5 - react/88-archive/9-routing.md",sourceDirName:"frontend/5 - react/88-archive",slug:"/frontend/react/archive/routing",permalink:"/knowledge-bank/docs/frontend/react/archive/routing",draft:!1,editUrl:"https://github.com/EvgenyLeukhin/knowledge-bank/edit/main/docs/frontend/5 - react/88-archive/9-routing.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"\u0420\u043e\u0443\u0442\u0438\u043d\u0433",sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438",permalink:"/knowledge-bank/docs/frontend/react/archive/best-practice"},next:{title:"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0441\u0442\u0438\u043b\u0438",permalink:"/knowledge-bank/docs/frontend/react/archive/components"}},c={},u=[{value:"react-router-dom",id:"react-router-dom",level:2},{value:"react-router-dom v. 5",id:"react-router-dom-v-5",level:2},{value:"App - create router",id:"app---create-router",level:3},{value:"Router - routes",id:"router---routes",level:3},{value:"PermissionsRoute",id:"permissionsroute",level:3},{value:"history - redirects",id:"history---redirects",level:3},{value:"NavLink",id:"navlink",level:3},{value:"react-router-dom v. 6",id:"react-router-dom-v-6",level:2},{value:"App",id:"app",level:3},{value:"Router",id:"router",level:3},{value:"NavLink",id:"navlink-1",level:3},{value:"Navigation",id:"navigation",level:3}],l={toc:u};function p(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,r.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"react-router-dom"},"react-router-dom"),(0,o.kt)("p",null,"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432: ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn add react-router-dom @types/react-router-dom")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"react-router-dom-v-5"},"react-router-dom v. 5"),(0,o.kt)("h3",{id:"app---create-router"},"App - create router"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { BrowserRouter as Router } from 'react-router-dom';\nimport Routes from 'routes';\n\n...\n  <Router>\n      <Routes />\n  </Router>\n...\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"router---routes"},"Router - routes"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { matchPath, Redirect, Route, Switch } from 'react-router-dom';\nimport { IRoute } from './interfaces';\nimport { EPermission } from './interfaces/auth';\n\n// routes components\nimport {\n  Login,\n  Drugstores,\n  Edit,\n  Help,\n  MassEdit,\n  Map,\n  MapOld,\n  CustomStatuses,\n  PermissionsRoute,\n  Regions,\n} from 'container';\n\nexport const AUTH = 'login';\nexport const MAIN = 'main';\nexport const MAP = 'map';\nexport const MAP_TEST = 'map-test';\nexport const EDIT = 'edit';\nexport const MASS_EDIT = 'mass_edit';\nexport const STATUSES = 'statuses';\nexport const HELP = 'help';\nexport const REGIONS = 'regions';\n\nexport const routes: IRoute[] = [\n  {\n    id: AUTH,\n    path: `/${AUTH}`,\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Login />,\n  },\n  {\n    id: MAIN,\n    path: '/',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Drugstores />,\n  },\n  {\n    id: MASS_EDIT,\n    path: '/mass_edit',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <MassEdit />,\n  },\n  {\n    id: EDIT,\n    path: '/edit/:id',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Edit />,\n  },\n  {\n    id: MAP,\n    path: '/map',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Map />,\n  },\n  {\n    id: MAP_TEST,\n    path: '/map-test',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <MapOld />,\n  },\n  {\n    id: STATUSES,\n    path: '/statuses',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <CustomStatuses />,\n  },\n  {\n    id: HELP,\n    path: '/help',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Help />,\n  },\n  {\n    id: REGIONS,\n    path: '/regions',\n    exact: true,\n    permissions: [EPermission.NONE],\n    children: <Regions />,\n  },\n];\n\nconst Routes = () => {\n  return (\n    <Switch>\n      {routes.map(props => {\n        return <PermissionsRoute key={props.id} {...props} />;\n      })}\n\n      <Route path='*'>\n        <Redirect to='/' />\n      </Route>\n    </Switch>\n  );\n};\n\nexport default Routes;\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"permissionsroute"},"PermissionsRoute"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { EPermission, IPermission } from 'interfaces/auth';\nimport { IRoute } from 'interfaces';\nimport { useSelector } from 'react-redux';\nimport { TStore } from 'store/store';\nimport { useAlert } from 'react-alert';\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\nimport Loader from 'components/ui/Loader/Loader';\nimport { AUTH } from 'routes';\nimport { useEffect } from 'react';\n\ninterface IPermissionsRoute extends RouteProps, IRoute {\n  permissions: IPermission[];\n}\n\nconst PermissionsRoute = ({\n  children,\n  permissions,\n  id,\n  ...rest\n}: IPermissionsRoute) => {\n  const alert = useAlert();\n\n  const {\n    permissions: userPermissions,\n    sessionInit,\n    uId,\n  } = useSelector((state: TStore) => ({\n    token: state.auth.token,\n    uId: state.auth.upn,\n    permissions: state.auth.permissions,\n    sessionInit: state.auth.init,\n  }));\n\n  let hasPermissions =\n    permissions.every(permission => {\n      return userPermissions?.includes(permission);\n    }) || false;\n  if (permissions.includes(EPermission.NONE)) hasPermissions = true;\n\n  let component;\n\n  if (!sessionInit) {\n    component = <Route {...rest} render={() => <Loader loading={true} />} />;\n  } else {\n    if (!uId && id !== AUTH) {\n      component = <Redirect to='/login' />;\n    } else if (!!uId && id === AUTH) {\n      component = <Redirect to='/' />;\n    } else {\n      component = (\n        <Route\n          {...rest}\n          render={() =>\n            hasPermissions ? <>{children}</> : <Redirect to='/' />\n          }\n        />\n      );\n    }\n  }\n\n  useEffect(() => {\n    if (!hasPermissions && sessionInit) {\n      alert.error(\n        '403. \u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b. \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438',\n      );\n    }\n  }, [sessionInit]);\n\n  return component;\n};\n\nexport default PermissionsRoute;\n")),(0,o.kt)("h3",{id:"history---redirects"},"history - redirects"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useHistory } from 'react-router-dom';\n\n...\n\nconst history = useHistory();\n\n...\n\nhistory.push('/some-page');\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"navlink"},"NavLink"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"...\n<NavLink to={`/administration/routes?query=${someConts}`} target='_blank'>\n    Link to new page\n</NavLink>\n...\n")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"react-router-dom-v-6"},"react-router-dom v. 6"),(0,o.kt)("h3",{id:"app"},"App"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import * as React from 'react';\nimport * as ReactDOM from 'react-dom/client';\nimport { createBrowserRouter, RouterProvider } from 'react-router-dom';\n\nconst router = createBrowserRouter([\n  {\n    path: '/',\n    element: <div>Hello world!</div>,\n  },\n]);\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <RouterProvider router={router} />\n  </React.StrictMode>,\n);\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"router"},"Router"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const router = createBrowserRouter([\n  {\n    path: '/',\n    element: <div>Hello world!</div>,\n\n    // not-found\n    errorElement: <NotFoundPage />,\n\n    // sub-routes\n    children: [\n      {\n        path: 'contacts/:contactId',\n        element: <Contact />,\n      },\n    ],\n\n    loader: someLoader,\n    action: someAction, // import action\n  },\n]);\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"navlink-1"},"NavLink"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'import { NavLink } from "react-router-dom";\n\n...\n\n<ul>\n  {contacts.map((contact) => (\n    <li key={contact.id}>\n      <NavLink\n        to={`contacts/${contact.id}`}\n        className={({ isActive, isPending }) =>\n          isActive\n            ? "active"\n            : isPending\n            ? "pending"\n            : ""\n        }\n      >\n        {/* other code */}\n      </NavLink>\n    </li>\n  ))}\n</ul>\n')),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"navigation"},"Navigation"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'import { useNavigation } from "react-router-dom";\n\n...\n\nconst navigation = useNavigation();\n\n\n...\n\n<div\n  id="detail"\n  className={navigation.state === "loading" ? "loading" : ""}\n>\n  Some content\n</div>\n\n...\nonClick={() => {\n  navigation(-1);\n  navigation(\'/redirect-page\');\n}}\n\n\n')))}p.isMDXComponent=!0}}]);