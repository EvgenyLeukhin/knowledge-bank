<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta property="og:type" content="website" />
    <meta property="og:title" content="TODO-LIST by HTML/CSS/JS" />
    <meta
      property="og:site_name"
      content="TODO list created by native frontend technologies without any libs and frameworks"
    />
    <meta property="og:locate" content="ru_RU" />
    <meta
      property="og:description"
      content="TODO list created by native frontend technologies without any libs and frameworks"
    />
    <meta name="twitter:title" content="TODO-LIST by HTML/CSS/JS" />
    <meta
      name="twitter:description"
      content="TODO list created by native frontend technologies without any libs and frameworks"
    />
    <meta itemprop="name" content="TODO-LIST by HTML/CSS/JS" />
    <meta
      itemprop="description"
      content="TODO list created by native frontend technologies without any libs and frameworks"
    />
    <meta name="theme-color" content="#ddd" />
    <meta name="application-name" content="TODO-LIST by HTML/CSS/JS" />
    <meta name="language" content="EN" />

    <!-- favicons -->
    <link
      rel="icon"
      type="image/png"
      href="favicons/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="favicons/favicon.svg" />
    <link rel="shortcut icon" href="favicons/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="favicons/apple-touch-icon.png"
    />
    <meta name="apple-mobile-web-app-title" content="Todo List" />
    <link rel="manifest" href="favicons/site.webmanifest" />

    <title>TODO-LIST by HTML/CSS/JS</title>

    <style>
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      :root {
        /* css vars */
        --s: 82px; /* control the size*/
        --c1: #b2b2b2;
        --c2: #ffffff;
        --c3: #d9d9d9;

        --_g: var(--c3) 0 120deg, #0000 0;
      }

      html {
        background: conic-gradient(from -60deg at 50% calc(100% / 3), var(--_g)),
          conic-gradient(from 120deg at 50% calc(200% / 3), var(--_g)),
          conic-gradient(
            from 60deg at calc(200% / 3),
            var(--c3) 60deg,
            var(--c2) 0 120deg,
            #0000 0
          ),
          conic-gradient(
            from 180deg at calc(100% / 3),
            var(--c1) 60deg,
            var(--_g)
          ),
          linear-gradient(
            90deg,
            var(--c1) calc(100% / 6),
            var(--c2) 0 50%,
            var(--c1) 0 calc(500% / 6),
            var(--c2) 0
          );
        background-size: calc(1.732 * var(--s)) var(--s);
      }

      html,
      body {
        margin: 0;
      }

      body {
        display: flex;
        padding: 15px;
        flex-direction: column;
        justify-content: center;
        min-height: 100vh;
        background-color: rgba(0, 0, 0, 0.25);
        font-family: sans-serif;
      }

      .container {
        width: 380px;
        margin: 0 auto;
        padding: 15px;
        outline: 5px solid #ccc;
        background-color: #ddd;
        border-radius: 5px;
      }

      .form-container {
        display: flex;
        justify-content: space-between;
        margin-right: 20px;
        margin-left: 20px;
      }

      .form-container button {
        height: 34px;
        flex-basis: 70px;
        flex-grow: 0;
        flex-shrink: 0;
        background-color: deepskyblue;
        transition-property: filter;
        transition-duration: 230ms;
        border-radius: 5px;
        border: none;
      }

      .form-container button:hover {
        cursor: pointer;
        filter: brightness(1.1);
      }

      .form-container input {
        flex-basis: 80%;
        flex-grow: 1;
        flex-shrink: 1;
        margin-right: 10px;
        width: auto;
        height: 34px;
        border-radius: 5px;
        border: 2px solid #ccc;
        padding: 5px 10px;
        transition-property: border;
        transition-duration: 230ms;
      }

      .form-container input:focus {
        outline: none;
        border: 2px solid deepskyblue;
      }

      h2 {
        text-align: center;
        margin-top: 0;
        text-transform: uppercase;
      }

      .list {
        margin-left: 20px;
        margin-right: 20px;
        margin-bottom: 0;
        padding-left: 0;
        background-color: white;
        border: 1px solid #ccc;
        border-radius: 5px;
        min-height: 100px;
        padding: 15px;
        transition-property: opacity;
        transition-duration: 230ms;
        opacity: 0;
      }

      .list.show {
        opacity: 1;
      }

      .list li {
        position: relative;
        z-index: 1;
        display: flex;
        align-items: center;
        transition-delay: 50ms;
        transition-property: background-color, outline;
        transition-duration: 230ms;
        cursor: default;
        margin-bottom: 10px;
        outline: 5px solid transparent;
      }

      .list li:last-child {
        margin-bottom: 0;
      }

      .list li:hover {
        background-color: #eee;
        outline: 5px solid #eee;
      }

      .list span:last-child {
        margin-left: auto;
      }

      .list li span:first-child {
        word-break: break-all;
      }

      .list li.checked span:first-child {
        text-decoration: line-through;
      }

      .list .check {
        cursor: default;
      }

      .list li.checked .check {
        opacity: 1;
      }

      .list li b {
        opacity: 0;
        transition-property: opacity;
        transition-duration: 230ms;
        transition-delay: 150ms;
      }

      .list li:hover b {
        opacity: 0.25;
      }

      .list .delete {
        position: absolute;
        right: -40px;
        z-index: 2;
      }

      .list .delete:hover {
        cursor: pointer;
        opacity: 1;
      }

      /* Адаптивность */
      @media screen and (max-width: 500px) {
        body {
          padding: 10px;
        }

        .container {
          width: 90%;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h2>TODO - list</h2>

      <div class="todo">
        <label for="input" hidden>Enter TODO</label>

        <div class="form-container">
          <input
            type="text"
            id="input"
            name="input"
            required
            placeholder="Enter todo"
          />
          <button id="button">Add</button>
        </div>

        <ul id="list" class="list"></ul>
      </div>
    </div>

    <script>
      // хранилище todo
      let todo = JSON.parse(localStorage.getItem('todo-list')) || [];

      // html элементы
      const input = document.querySelector('#input');
      const button = document.querySelector('#button');
      const list = document.querySelector('#list');

      // рендер списка при загрузке
      document.addEventListener('DOMContentLoaded', function () {
        setTimeout(() => {
          list.classList.add('show');
        }, 230);

        renderList();
      });

      // функция для рендера списка
      const renderList = () => {
        // очищает старые <li>, чтобы они не повторялись
        list.innerHTML = '';

        localStorage.setItem('todo-list', JSON.stringify(todo));

        // перебираем массив todo
        todo.forEach((todoItem, index) => {
          // создаем новый тэг <li>, сохраняя его в переменную, но пока никуда не вставляем
          const li = document.createElement('li');

          // добавляем css-класс list-item
          // li.classList.add('list-item');

          // добавляем id = todoItem.id
          // li.setAttribute('id', todoItem.id);

          // добвляем контент во внутрь <li> - можно еще так
          // li.textContent = `${index + 1}. ${todoItem.text}`;

          // добвляем внутреннюю разметку для каждого <li>
          li.innerHTML = `
          <span>${index + 1}. ${todoItem.text}</span>

          <span>
            <b class="check">✅</b>
            <b class="delete">❌</b>
          </span>
        `;

          // добавляем css-класс checked, если checked: true
          if (todoItem.checked) {
            li.classList.add('checked');
          }

          // вставляем <li> в список
          list.appendChild(li);

          // навешивание события клика на тег <li> для отмечания todo
          li.addEventListener('click', () => {
            checkTodo(todoItem.id);
          });

          // навешивание события клика на тег <b class="delete"> для удаления todo
          li.querySelector('.delete').addEventListener('click', () => {
            removeTodo(todoItem.id);
          });
        });
      };

      // функция отметки todo
      const checkTodo = (id) => {
        todo = todo.map((todo) => {
          if (todo.id === id) {
            return { ...todo, checked: !todo.checked };
          }
          return todo;
        });

        renderList();
      };

      // функция добавления todo
      const addTodo = () => {
        const value = input.value.trim();

        if (value) {
          // добавляем todo в массив с кастомными полями
          todo.push({
            id: Date.now(),
            text: value,
            checked: false,
          });

          // очищаем поле инпута
          input.value = '';
        }

        renderList();
      };

      // функция удаления todo по id
      const removeTodo = (id) => {
        // I вариант - с помощью .filter()
        todo = todo.filter((item) => item.id !== id);

        // II вариант - с помощью .findIndex() и .splice()
        // const deletedIndex = todo.findIndex((item)  => item.id === id);
        // todo.splice(deletedIndex, 1);

        // render list
        renderList();
      };

      // событие клика на кнопку
      button.addEventListener('click', () => {
        addTodo();
      });

      // событие нажатия Enter в поле ввода
      input.addEventListener('keydown', (event) => {
        const value = event.target.value;

        if (value && event.key === 'Enter') {
          addTodo();
        }
      });
    </script>
  </body>
</html>
